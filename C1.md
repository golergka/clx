# Clx v1 Review & Testing Checklist

## Before Release

---

## 1. Edge Cases & Error Handling

### OpenAPI Spec Parsing
- [ ] Spec with no paths (empty API)
- [ ] Spec with only deprecated endpoints
- [ ] Spec with circular $ref references
- [ ] Spec with external $ref (URLs)
- [ ] Spec missing required fields (info, paths)
- [ ] Spec with unsupported OpenAPI version (2.0/Swagger)
- [ ] Malformed YAML/JSON (syntax errors)
- [ ] Very large spec (10MB+)
- [ ] Spec with unicode in operation IDs and paths
- [ ] Spec with path parameters containing special chars (`/users/{user-id}` vs `/users/{userId}`)

### Command Parsing
- [ ] Command with no arguments
- [ ] Unknown subcommand (`stripe foobar`)
- [ ] Ambiguous command matching
- [ ] Very long command chain (`stripe customers subscriptions invoices...`)
- [ ] Flags with equals vs space (`--limit=10` vs `--limit 10`)
- [ ] Flags with empty values (`--name=""`)
- [ ] Boolean flags (`--verbose` vs `--verbose=true`)
- [ ] Repeated flags (`--tag=a --tag=b`)
- [ ] Unknown flags
- [ ] Conflicting flags (if any)

### Input Handling
- [ ] Empty stdin when expecting JSON
- [ ] Malformed JSON via stdin
- [ ] Very large JSON payload (1MB+)
- [ ] JSON with nested objects 10+ levels deep
- [ ] Binary data via stdin
- [ ] Mix of stdin and flags (which wins?)
- [ ] Unicode in request body
- [ ] Special characters in flag values (quotes, newlines, tabs)

### Authentication
- [ ] No auth configured, API requires auth
- [ ] Expired token
- [ ] Invalid/revoked token
- [ ] Token refresh failure
- [ ] Multiple auth profiles, none selected
- [ ] Auth file corrupted/malformed
- [ ] Auth file missing permissions (chmod 000)
- [ ] OAuth flow interrupted (user closes browser)
- [ ] OAuth callback server port in use

### Network & HTTP
- [ ] API server unreachable (DNS failure)
- [ ] Connection timeout
- [ ] SSL certificate errors
- [ ] HTTP 429 rate limit (should show retry-after?)
- [ ] HTTP 5xx errors
- [ ] HTTP 3xx redirects (follow? how many?)
- [ ] Response not JSON (HTML error page)
- [ ] Very large response (100MB+)
- [ ] Slow response (30s+)
- [ ] Connection dropped mid-response
- [ ] IPv6-only servers

### Filesystem
- [ ] `~/.config/clx/` doesn't exist
- [ ] `~/.config/clx/` not writable
- [ ] Disk full during spec download
- [ ] Symlink creation fails (no permission on `/usr/local/bin/`)
- [ ] Spec file deleted after install
- [ ] Config file corrupted
- [ ] Concurrent clx processes (race conditions)

---

## 2. Functional Testing

### Package Manager
- [ ] `clx install <api>` — downloads spec, creates symlink
- [ ] `clx install <api>` — already installed (idempotent?)
- [ ] `clx remove <api>` — removes spec and symlink
- [ ] `clx remove <api>` — not installed
- [ ] `clx list` — shows installed APIs
- [ ] `clx list` — nothing installed
- [ ] `clx update <api>` — fetches new version
- [ ] `clx update <api>` — no updates available
- [ ] `clx update --all` — updates everything
- [ ] `clx search <term>` — finds matches
- [ ] `clx search <term>` — no matches
- [ ] `clx add ./local.yaml --name myapi` — custom spec

### Auth Commands
- [ ] `<api> auth login` — interactive flow
- [ ] `<api> auth login --profile prod` — named profile
- [ ] `<api> auth status` — shows current auth
- [ ] `<api> auth logout` — clears credentials
- [ ] `<api> auth switch <profile>` — switches profile
- [ ] `<api> auth list` — shows all profiles

### API Execution
- [ ] GET request with query params
- [ ] GET request with path params
- [ ] POST request with JSON body (flags)
- [ ] POST request with JSON body (stdin)
- [ ] PUT request
- [ ] PATCH request
- [ ] DELETE request
- [ ] Request with custom headers
- [ ] Request with file upload (multipart)
- [ ] `--dry-run` shows curl equivalent
- [ ] `--verbose` shows request/response details
- [ ] Output is valid JSON
- [ ] Errors go to stderr
- [ ] Exit code 0 on success
- [ ] Exit code non-zero on failure

### Help System
- [ ] `clx --help`
- [ ] `<api> --help`
- [ ] `<api> <resource> --help`
- [ ] `<api> <resource> <action> --help`
- [ ] Help shows all available flags
- [ ] Help shows required vs optional params
- [ ] Help output is <50 tokens (agent-friendly)

---

## 3. API Compatibility Matrix

Test against actual APIs in the registry:

| API | Install | Auth | GET | POST | PUT | DELETE |
|-----|---------|------|-----|------|-----|--------|
| Stripe | [ ] | [ ] | [ ] | [ ] | [ ] | [ ] |
| GitHub | [ ] | [ ] | [ ] | [ ] | [ ] | [ ] |
| OpenAI | [ ] | [ ] | [ ] | [ ] | [ ] | [ ] |
| Anthropic | [ ] | [ ] | [ ] | [ ] | [ ] | [ ] |
| Linear | [ ] | [ ] | [ ] | [ ] | [ ] | [ ] |
| Slack | [ ] | [ ] | [ ] | [ ] | [ ] | [ ] |
| Twilio | [ ] | [ ] | [ ] | [ ] | [ ] | [ ] |
| Discord | [ ] | [ ] | [ ] | [ ] | [ ] | [ ] |
| Notion | [ ] | [ ] | [ ] | [ ] | [ ] | [ ] |
| Petstore | [ ] | [ ] | [ ] | [ ] | [ ] | [ ] |

---

## 4. Platform Testing

- [ ] macOS (Intel)
- [ ] macOS (Apple Silicon)
- [ ] Ubuntu 22.04
- [ ] Ubuntu 24.04
- [ ] Debian
- [ ] Fedora
- [ ] Homebrew install works
- [ ] Binary runs without dependencies
- [ ] XDG paths respected (`$XDG_CONFIG_HOME`)

---

## 5. Security Review

- [ ] Auth tokens stored with restricted permissions (600)
- [ ] Tokens not logged in `--verbose` output
- [ ] Tokens not visible in `--dry-run` curl output
- [ ] No credentials in error messages
- [ ] HTTPS enforced for registry downloads
- [ ] Spec integrity verification (checksum?)
- [ ] No arbitrary code execution from specs
- [ ] Path traversal in spec filenames prevented

---

## 6. Performance

- [ ] Cold start time < 200ms
- [ ] Spec parsing time for large spec < 500ms
- [ ] Memory usage < 100MB for typical operation
- [ ] No memory leaks on repeated calls
- [ ] Binary size reasonable (< 50MB)

---

## 7. Documentation

- [ ] README with quick start
- [ ] `clx --help` is self-explanatory
- [ ] Error messages include actionable guidance
- [ ] Man page or `clx help <topic>`?
- [ ] Examples for common workflows

---

## 8. Agent-Specific Testing

Since the primary user is AI coding agents:

- [ ] Help output is token-efficient
- [ ] JSON output parseable without preprocessing
- [ ] Error messages structured (not just stack traces)
- [ ] `--dry-run` output is copy-paste ready
- [ ] No interactive prompts in non-TTY mode
- [ ] Works in CI/CD environments (no TTY)
- [ ] Stdin piping works reliably
- [ ] Exit codes are semantic (different codes for different errors?)

---

## 9. Improvements to Consider

### Before v1.0
- [ ] Shell completion (bash, zsh, fish)
- [ ] `--output=table` for human-readable output
- [ ] `--field` extraction (`stripe customers get X --field=email`)
- [ ] `--jq` built-in filtering
- [ ] Retry logic with exponential backoff for 429/5xx
- [ ] Offline mode indicator
- [ ] `clx doctor` to diagnose setup issues

### Post v1.0
- [ ] Spec version pinning (`clx install stripe@2024-01-01`)
- [ ] Private registry support
- [ ] Proxy support (`HTTP_PROXY`, `HTTPS_PROXY`)
- [ ] Request logging/history
- [ ] Response caching
- [ ] Webhooks testing mode
- [ ] GraphQL support (separate tool?)
- [ ] Plugin system for custom auth flows

---

## 10. Release Checklist

- [ ] Version number set correctly
- [ ] CHANGELOG updated
- [ ] License file present
- [ ] All tests passing
- [ ] Binary builds for all platforms
- [ ] Homebrew formula tested
- [ ] GitHub release created
- [ ] Registry specs verified current
- [ ] Announce (Twitter, HN, Reddit?)